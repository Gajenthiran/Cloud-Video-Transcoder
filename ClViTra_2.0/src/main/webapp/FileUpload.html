<html>
<head>
	<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
	<script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>

	<script>
	
	if(localStorage.annLogin==null) {
		window.location="Login.html";
	}
	
	</script>
</head>



<body>
	<h1>File Upload with Jersey</h1>
 
	<form id="upload_form" action="/ClViTra_2.0/rest/upload" method="post" enctype="multipart/form-data">
 
	   <p>
		Select a file : <input type="file" name="file" size="45" />
	   </p>
	   <input type="submit" value="Upload It" />
	   
	</form> 

	
	<div id='videolist'></div>	
	<script>
	
	$( "#upload_form" ).submit(function( event ) {
	
  		
		event.preventDefault();
		var form_data = new FormData($("#upload_form")[0]);
  		$.ajax({
	        url: "/ClViTra_2.0/rest/upload",
	        type: "POST",
	        data: form_data,
	        processData:false,
	        contentType:false,
	        beforeSend: function(xhr) {
	            xhr.setRequestHeader("User", localStorage.annLogin);
	        },
	        success: function(value) {
	        	console.log("success1");
	        }, error: function(e){console.log(e)}
  		});
  		//
  		return false;
	});
	
	$.ajax({
	        url: "/ClViTra_2.0/rest/videos/"+localStorage.annLogin+"/initialized",
	        type: "GET",
	        dataType:'json',
	        //beforeSend: function(xhr) {
	            //xhr.setRequestHeader("User", localStorage.annCred);
	        //}, 
	        success: function(value) {
	        	console.log(value);
	        	
	        	$('#videolist').text(value);
	        	//window.location="FileUpload.html";
	        	
	            //that._login = login;
	            //that._cred = credentials;

	            //localStorage.setItem("annLogin",login);
	            //localStorage.setItem("annCred",credentials);

	            //callback({status:"ok", code:200});
	        //}, statusCode: {
	            // if user does not exist, return authentication failed.
	          //  404: function() {
	            //    callback({status:"not found", code:404});
	            //},
	            // if credentials were not correct, return authentication failed.
	            //401: function() {
	              //  callback({status:"unauthorized", code:401});
	            //},
	            // something went wrong....
	            //500: function() {
	              //  callback({status:"server error", code:500});
	            //}
	        }
	    });
	    </script>
	
	
</body>
</html>